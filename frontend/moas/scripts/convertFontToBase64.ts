// scripts/convertFontToBase64.ts

import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const FONTS_DIR = path.join(__dirname, '../src/lib/fonts');
const OUTPUT_FILE = path.join(__dirname, '../src/lib/fonts.ts');

const fonts = [
  { file: 'BookkMyungjo_Light.ttf', name: 'BookkMyungjo', weight: 'normal' },
  { file: 'BookkMyungjo_Bold.ttf', name: 'BookkMyungjo', weight: 'bold' },
];

const convertFontsToBase64 = () => {
  console.log('ğŸ”„ í°íŠ¸ ë³€í™˜ ì‹œì‘...');
  console.log(`ğŸ“‚ í°íŠ¸ ë””ë ‰í† ë¦¬: ${FONTS_DIR}`);

  const fontData: Record<string, string> = {};

  fonts.forEach(({ file, name, weight }) => {
    const fontPath = path.join(FONTS_DIR, file);

    if (!fs.existsSync(fontPath)) {
      console.error(`âŒ í°íŠ¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${fontPath}`);
      process.exit(1);
    }

    console.log(`ğŸ“ ë³€í™˜ ì¤‘: ${file}...`);
    const fontBuffer = fs.readFileSync(fontPath);
    const base64 = fontBuffer.toString('base64');

    fontData[`${name}-${weight}`] = base64;
    console.log(`âœ… ${file} ë³€í™˜ ì™„ë£Œ (í¬ê¸°: ${Math.round(base64.length / 1024)}KB)`);
  });

  const output = `// Auto-generated font data
// Do not edit this file manually
// Generated by: pnpm run convert-fonts

export const FONTS = {
  'BookkMyungjo-normal': '${fontData['BookkMyungjo-normal']}',
  'BookkMyungjo-bold': '${fontData['BookkMyungjo-bold']}',
};
`;

  fs.writeFileSync(OUTPUT_FILE, output);
  console.log('\nâœ… í°íŠ¸ ë³€í™˜ ì™„ë£Œ!');
  console.log(`ğŸ“„ ì¶œë ¥ íŒŒì¼: ${OUTPUT_FILE}`);
  console.log(`ğŸ“Š ì´ íŒŒì¼ í¬ê¸°: ${Math.round(fs.statSync(OUTPUT_FILE).size / 1024)}KB`);
};

convertFontsToBase64();
